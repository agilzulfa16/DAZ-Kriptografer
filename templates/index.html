<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DAZ Kriptografer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê DAZ Kriptografer</h1>
            <p>Enkripsi dan Dekripsi dengan Berbagai Algoritma Cipher</p>
        </div>

        <div class="content">
            <div id="alertBox"></div>

            <form id="cipherForm">
                <div class="form-group">
                    <label for="cipherType">Pilih Metode Cipher:</label>
                    <select id="cipherType" name="cipher_type" class="form-control" required>
                        <option value="">-- Pilih Cipher --</option>
                        <option value="vigenere">Vigenere Cipher (26 huruf)</option>
                        <option value="autokey">Auto-Key Vigenere Cipher (26 huruf)</option>
                        <option value="extended_vigenere">Extended Vigenere Cipher (256 ASCII)</option>
                        <option value="playfair">Playfair Cipher (26 huruf)</option>
                        <option value="affine">Affine Cipher (26 huruf)</option>
                        <option value="hill">Hill Cipher (26 huruf)</option>
                        <option value="super">Super Enkripsi (Extended Vigenere + Transposisi)</option>
                        <option value="enigma">Enigma Cipher</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Mode Operasi:</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="operation" value="encrypt" checked>
                            Enkripsi
                        </label>
                        <label>
                            <input type="radio" name="operation" value="decrypt">
                            Dekripsi
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Input Data:</label>
                    <div class="radio-group">
                        <label id="labelTextOption">
                            <input type="radio" name="input_type" value="text" checked id="radioText">
                            Teks Manual
                        </label>
                        <label id="labelFileOption">
                            <input type="radio" name="input_type" value="file" id="radioFile">
                            Upload File
                        </label>
                    </div>
                </div>

                <div id="textInput" class="form-group">
                    <label for="inputText">Masukkan Teks:</label>
                    <textarea id="inputText" name="text" class="form-control" placeholder="Ketik atau paste teks di sini..."></textarea>
                </div>

                <div id="fileInput" class="form-group" style="display: none;">
                    <label>Upload File:</label>
                    <div class="file-input-wrapper">
                        <label class="file-input-label" for="fileUpload">
                            üìÅ Pilih File
                        </label>
                        <input type="file" id="fileUpload" name="file">
                        <span class="file-name" id="fileName">Belum ada file dipilih</span>
                    </div>
                    <p class="info-text" id="fileInfo">File dapat berupa text, gambar, document, atau file binary lainnya</p>
                </div>

                <div id="keyGroup" class="form-group">
                    <label for="key">Kunci Enkripsi/Dekripsi:</label>
                    <input type="text" id="key" name="key" class="form-control" placeholder="Masukkan kunci..." required>
                    <p class="info-text">Untuk cipher 26 huruf, hanya huruf A‚ÄìZ yang diproses; spasi & tanda baca akan dihapus.</p>
                </div>

                <!-- Cipher-specific options -->
                <div id="affineOptions" class="cipher-options">
                    <h3>Parameter Affine Cipher</h3>
                    <div class="grid-2">
                        <div class="form-group">
                            <label for="affineA">Parameter a (harus coprime dengan 26):</label>
                            <input type="number" id="affineA" name="affine_a" class="form-control" value="5" min="1">
                        </div>
                        <div class="form-group">
                            <label for="affineB">Parameter b:</label>
                            <input type="number" id="affineB" name="affine_b" class="form-control" value="8" min="0">
                        </div>
                    </div>
                </div>

                <div id="hillOptions" class="cipher-options">
                    <h3>Parameter Hill Cipher</h3>
                    <div class="form-group">
                        <label for="matrixSize">Ukuran Matriks:</label>
                        <select id="matrixSize" name="matrix_size" class="form-control">
                            <option value="2">2x2</option>
                            <option value="3" selected>3x3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hillMatrix">Matriks Kunci (format JSON array):</label>
                        <textarea id="hillMatrix" name="hill_matrix" class="form-control" rows="3">[[6,24,1],[13,16,10],[20,17,15]]</textarea>
                        <p class="info-text">Contoh 2x2: [[3,3],[2,5]] | Contoh 3x3: [[6,24,1],[13,16,10],[20,17,15]]</p>
                    </div>
                </div>

                <div id="superOptions" class="cipher-options">
                    <h3>Parameter Super Enkripsi</h3>
                    <div class="form-group">
                        <label for="key2">Kunci Transposisi Kolom:</label>
                        <input type="text" id="key2" name="key2" class="form-control" placeholder="Contoh: SECRETKEY" value="KEY">
                    </div>
                </div>

                <div id="enigmaOptions" class="cipher-options">
                    <h3>Parameter Enigma Cipher</h3>
                    <div class="grid-2">
                        <div class="form-group">
                            <label for="enigmaRotor">Posisi Rotor (3 huruf):</label>
                            <input type="text" id="enigmaRotor" name="enigma_rotor" class="form-control" placeholder="AAA" value="AAA" maxlength="3" pattern="[A-Za-z]{3}">
                        </div>
                        <div class="form-group">
                            <label for="enigmaRing">Ring Settings (3 huruf):</label>
                            <input type="text" id="enigmaRing" name="enigma_ring" class="form-control" placeholder="AAA" value="AAA" maxlength="3" pattern="[A-Za-z]{3}">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary">üîí Proses</button>
                    <button type="button" class="btn btn-secondary" id="resetBtn">üîÑ Reset</button>
                </div>
            </form>

            <div class="loading" id="loadingBox">
                <div class="spinner"></div>
                <p>Memproses...</p>
            </div>

            <div class="result-section" id="resultSection">
                <h3>üìä Hasil:</h3>
                <div class="result-box" id="resultBox"></div>
                
                <h3 style="margin-top: 25px;">üìù Base64 Encoding:</h3>
                <div class="result-box" id="base64Box"></div>

                <div style="margin-top: 20px;">
                    <button class="btn btn-success" id="downloadBtn">üíæ Download Hasil</button>
                    <button class="btn btn-secondary" id="copyBtn">üìã Copy Base64</button>
                </div>
            </div>

            <!-- Playfair preview (opsional) -->
            <div id="playfairPreview" style="display:none; margin-top:20px;">
                <h4>Playfair: Preview pembersihan & pasangan</h4>
                <div id="playfairPreviewBox" class="result-box"></div>
            </div>

            <div id="footer">
                <p>&copy; 2025 Dibuat oleh Agil Zulfa, Dimas Aditya, Zidan Fadlan</p>
            </div>
        </div>
    </div>

    <!-- expose server-side lists to JS -->
    <script>
        window.LETTER_ONLY = {{ letter_only | tojson | safe }};
        window.BINARY_SUPPORTED = {{ binary_supported | tojson | safe }};
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
